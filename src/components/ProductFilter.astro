---
// ProductFilter.astro
---
<div class="flex justify-center items-center mb-12 px-4">
    <div class="relative inline-flex bg-gray-100 rounded-full p-1 shadow border border-gray-200 overflow-hidden">
      
      <!-- Indicador dinámico -->
      <div id="indicator" class="absolute bg-blue-600 rounded-full transition-all duration-300 ease-out z-0" style="height: calc(100% - 8px); top: 4px; left: 4px; width: 0;"></div>
      
      <!-- Botones -->
      <button class="filter-btn relative z-10 px-5 py-2 text-sm font-medium rounded-full
         text-gray-600 hover:text-gray-800 transition-all duration-300 whitespace-nowrap
         border-0 focus:outline-none focus:ring-0 focus:border-0" data-category="all">
        Todos los proyectos
      </button>
      <button class="filter-btn relative z-10 px-5 py-2 text-sm font-medium rounded-full
         text-gray-600 hover:text-gray-800 transition-all duration-300 whitespace-nowrap
         border-0 focus:outline-none focus:ring-0 focus:border-0" data-category="agro">
        Agro
      </button>
      <button class="filter-btn relative z-10 px-5 py-2 text-sm font-medium rounded-full
         text-gray-600 hover:text-gray-800 transition-all duration-300 whitespace-nowrap
         border-0 focus:outline-none focus:ring-0 focus:border-0" data-category="jovenes">
        Jóvenes por Colombia
      </button>
      <button class="filter-btn relative z-10 px-5 py-2 text-sm font-medium rounded-full
         text-gray-600 hover:text-gray-800 transition-all duration-300 whitespace-nowrap
         border-0 focus:outline-none focus:ring-0 focus:border-0" data-category="store">
        Store
      </button>
      <button class="filter-btn relative z-10 px-5 py-2 text-sm font-medium rounded-full
         text-gray-600 hover:text-gray-800 transition-all duration-300 whitespace-nowrap
         border-0 focus:outline-none focus:ring-0 focus:border-0" data-category="makers">
        For Makers
      </button>
      <button class="filter-btn relative z-10 px-5 py-2 text-sm font-medium rounded-full
         text-gray-600 hover:text-gray-800 transition-all duration-300 whitespace-nowrap
         border-0 focus:outline-none focus:ring-0 focus:border-0" data-category="software">
        Software & Hardware
      </button>
    </div>
  </div>
  
  <script type="module">
    document.addEventListener('DOMContentLoaded', () => {
      const buttons = document.querySelectorAll('.filter-btn');
      const indicator = document.getElementById('indicator');
      const cards = document.querySelectorAll('.project-card'); // Asegúrate de tener elementos con esta clase
  
      function updateIndicator(button) {
        const rect = button.getBoundingClientRect();
        const parentRect = button.parentElement.getBoundingClientRect();
        const left = rect.left - parentRect.left;
        const width = rect.width;
  
        indicator.style.left = `${left}px`;
        indicator.style.width = `${width}px`;
      }
  
      function activateButton(button) {
        buttons.forEach(btn => {
          btn.classList.remove('text-white', 'bg-blue-600');
          btn.classList.add('text-gray-600');
        });
        button.classList.remove('text-gray-600');
        button.classList.add('text-white', 'bg-blue-600');
  
        updateIndicator(button);
      }
  
      function filterCards(category) {
        cards.forEach(card => {
          const cardCategory = card.dataset.category;
          if (category === 'all' || cardCategory === category) {
            card.style.display = 'block';
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
          } else {
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';
            setTimeout(() => {
              card.style.display = 'none';
            }, 300);
          }
        });
      }
  
      // Inicializa con el primer botón activo
      const initialButton = buttons[0];
      activateButton(initialButton);
      setTimeout(() => updateIndicator(initialButton), 100);
  
      buttons.forEach(button => {
        button.addEventListener('click', () => {
          const category = button.dataset.category;
          activateButton(button);
          filterCards(category);
        });
      });
  
      // Reajustar indicador en resize
      window.addEventListener('resize', () => {
        const active = document.querySelector('.filter-btn.bg-blue-600');
        if (active) updateIndicator(active);
      });
    });
  </script>
  